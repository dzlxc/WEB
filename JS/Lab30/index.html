<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>Лабораторна робота 30 — Пагінація</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        h2 { margin-top: 40px; }
        .box {
            padding: 10px;
            border: 1px solid #ccc;
            margin: 5px 0;
        }
        button {
            padding: 5px 15px;
            margin: 5px;
            cursor: pointer;
        }
        .pagination-buttons { margin-top: 10px; }
        .loader { text-align: center; padding: 20px; display: none; }
    </style>
</head>
<body>

<h1>Лабораторна робота №30 — Пагінація</h1>

<!-- ============================ 1. КЛІЄНТСЬКА ПАГІНАЦІЯ ============================ -->
<h2>1. Клієнтська пагінація (масив 100 елементів)</h2>

<div id="clientList"></div>
<div class="pagination-buttons">
    <button onclick="prevPage()">Попередня</button>
    <button onclick="nextPage()">Наступна</button>
</div>
<p id="clientPageInfo"></p>

<hr>

<!-- ============================ 2. СЕРВЕРНА ПАГІНАЦІЯ ============================ -->
<h2>2. Серверна пагінація (API JSONPlaceholder)</h2>

<div id="serverList"></div>
<div class="pagination-buttons">
    <button onclick="serverPrev()">Попередня</button>
    <button onclick="serverNext()">Наступна</button>
</div>
<p id="serverPageInfo"></p>

<hr>

<!-- ============================ 3. ІНФІНІТНА ПРОКРУТКА ============================ -->
<h2>3. Інфінітна прокрутка</h2>

<div id="infiniteList"></div>
<div class="loader" id="loader">Завантаження...</div>

<script>
    /* ============================================================
       1. КЛІЄНТСЬКА ПАГІНАЦІЯ
    ============================================================ */
    const clientData = Array.from({ length: 100 }, (_, i) => `Елемент ${i + 1}`);
    let clientPage = 1;
    const itemsPerPage = 10;

    function renderClientPage() {
        const start = (clientPage - 1) * itemsPerPage;
        const end = start + itemsPerPage;

        const pageItems = clientData.slice(start, end);

        const list = document.getElementById("clientList");
        list.innerHTML = pageItems.map(item => `<div class="box">${item}</div>`).join("");

        document.getElementById("clientPageInfo").textContent =
            `Сторінка ${clientPage} із ${Math.ceil(clientData.length / itemsPerPage)}`;
    }

    function nextPage() {
        if (clientPage < 10) {
            clientPage++;
            renderClientPage();
        }
    }

    function prevPage() {
        if (clientPage > 1) {
            clientPage--;
            renderClientPage();
        }
    }

    renderClientPage();


    /* ============================================================
       2. СЕРВЕРНА ПАГІНАЦІЯ (JSONPlaceholder)
    ============================================================ */
    let serverPage = 1;

    async function loadServerPage() {
        const response = await fetch(`https://jsonplaceholder.typicode.com/posts?_limit=10&_page=${serverPage}`);
        const data = await response.json();

        const list = document.getElementById("serverList");
        list.innerHTML = data.map(post =>
            `<div class="box"><b>${post.id}.</b> ${post.title}</div>`).join("");

        document.getElementById("serverPageInfo").textContent = `Сторінка: ${serverPage}`;
    }

    function serverNext() {
        serverPage++;
        loadServerPage();
    }

    function serverPrev() {
        if (serverPage > 1) {
            serverPage--;
            loadServerPage();
        }
    }

    loadServerPage();


    /* ============================================================
       3. ІНФІНІТНА ПРОКРУТКА
    ============================================================ */
    let infinitePage = 1;
    const infiniteList = document.getElementById("infiniteList");
    const loader = document.getElementById("loader");

    async function loadInfinite() {
        loader.style.display = "block";

        const res = await fetch(`https://jsonplaceholder.typicode.com/comments?_limit=10&_page=${infinitePage}`);
        const data = await res.json();

        data.forEach(item => {
            const div = document.createElement("div");
            div.className = "box";
            div.textContent = `${item.id}. ${item.email}`;
            infiniteList.appendChild(div);
        });

        loader.style.display = "none";
        infinitePage++;
    }

    window.addEventListener("scroll", () => {
        if (window.innerHeight + window.scrollY >= document.body.offsetHeight - 50) {
            loadInfinite();
        }
    });

    // перший запуск
    loadInfinite();
</script>

</body>
</html>